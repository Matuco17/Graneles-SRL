<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.prime.com.tr/ui">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundleSalario.CreateAdelantoTitle}"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <h:form>
                <p:panel id="panSeleccion" >
                    <h:panelGrid columns="4">
                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_personal}" for="personal" />
                        <h:selectOneMenu id="currentPersonal" value="#{adelantoController.currentPersonal}"  >
                           <f:selectItem itemLabel="---" />
                           <f:selectItems value="#{personalController.personalOrdenadoXCuil}" var="trabajador" itemLabel="#{trabajador.cuil}"/>
                        </h:selectOneMenu>
                        <h:outputLabel value="" />

                        <h:commandButton id="btnSeleccionarPersonal"
                                         action="#{adelantoController.seleccionarPersonal}" 
                                     value="#{bundlePersonal.AccidentadoTitle_seleccionarPersonal}" 
                                     label="#{bundlePersonal.AccidentadoTitle_seleccionarPersonal}" />
                   
           
                    </h:panelGrid>
                </p:panel>
            </h:form>
            <h:form>
                <p:panel id="panAdelanto" style="width: 350px; height: 300px;  float: left;" visible="#{adelantoController.currentPersonal != null}" >
                    <h:panelGrid columns="2">
                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_personal}" for="personal"/>
                        <h:outputText value="#{adelantoController.selected.personal.cuil}" id="personal" />
                        <h:outputText value="" />
                        <h:outputText value="#{adelantoController.selected.personal.apellido}"/>


                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_fecha}" for="fecha"/>
                        <p:calendar id="fecha" value="#{adelantoController.selected.fecha}" title="#{bundleSalario.AdelantoTitle_fecha}" pattern="dd/MM/yyyy"
                                    required="true" requiredMessage="#{bundleSalario.AdelantoRequiredMessage_fecha}"/>
                  
                   
                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_valorMaximo}" for="valorMaximo" />
                        <p:inputText id="valorMaximo" readonly="true" value="#{adelantoController.valorMaximoCalculado}" style="text-align: right;" />
                  
                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_valorTotalAdelantos}" for="valorTotal" />
                        <p:inputText id="valorTotal" readonly="true" value="#{adelantoController.valorTotalAdelantos}" style="text-align: right;" />
                  
                        <h:outputLabel value="#{bundleSalario.AdelantoTitle_valorADar}" for="valor" />
                        <p:inputText id="valor" value="#{adelantoController.selected.valor}" style="text-align: right;"
                                     required="true" requiredMessage="#{bundleSalario.AdelantoRequiredMessage_valor}"/>
              
                    </h:panelGrid>
                </p:panel>
                <p:panel id="panAdelantosPrevios" header="#{bundleSalario.AdelantoTitle_adelantosPrevios}" style="width: 280px; height: 300px; float: left;" visible="#{adelantoController.currentPersonal != null}" >
                    <p:dataTable id="dtbAdelantos" value="#{adelantoController.adelantosPersonalModel}" var="adelanto" 
                                 paginator="true" rows="8" paginatorTemplate="{CurrentPageReport}  {PreviousPageLink} {PageLinks} {NextPageLink} "
                        >
                        <p:column headerText="#{bundleSalario.AdelantoTitle_fecha}" style="text-align: center;" >
                            <h:outputText value="#{adelanto.fecha}" >
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>    
                        </p:column>
                        <p:column headerText="#{bundleSalario.AdelantoTitle_valor}" style="text-align: right;" >
                            <h:outputText value="#{adelanto.valor}"/>
                        </p:column>                        
                    </p:dataTable>
                </p:panel>
                
                <p:panel id="panAcciones" style="width: 100%; float: left;" visible="#{adelantoController.currentPersonal != null}" >
                    <h:panelGrid columns="2">
                        <h:commandButton action="#{adelantoController.create}"
                                         image="/faces/resources/images/save.png" 
                                         value="#{bundleSalario.AdelantoSaveLink}" 
                                         title="#{bundleSalario.AdelantoSaveLink}"
                                         />

                        <h:commandButton action="#{adelantoController.prepareList}"
                                         image="/faces/resources/images/viewAll.png" 
                                         value="#{bundleSalario.AdelantoShowAllLink}"
                                         title="#{bundleSalario.AdelantoShowAllLink}"
                                         immediate="true" 
                                         />

                    </h:panelGrid>
                </p:panel>
            </h:form>
        </ui:define>
    </ui:composition>

</html>
