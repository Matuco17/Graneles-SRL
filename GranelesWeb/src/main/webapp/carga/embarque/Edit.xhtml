<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:Cc="http://java.sun.com/jsf/composite/CompositeComponents">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundleCarga.EditEmbarqueTitle}"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <h:form enctype="multipart/form-data" >
                <div style="min-width: 650px; float:left;">
                    <p:fieldset legend="Datos del Embarque" toggleable="true"  >
                        
                        <Cc:embarqueDatosGenerales nuevo="false"/>
                        
                    </p:fieldset>
                    
                    <p:fieldset id="panTurnos" legend="Turnos" toggleable="true" collapsed="false" >
                   
                        <p:dataTable id="dtbTurnos" value="#{embarqueController.listaTurnos}" var="turno" >
                            <p:column headerText="Fecha">
                                <h:outputText value="#{turno.fecha}" >
                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                </h:outputText>   
                            </p:column>
                            <p:column headerText="Turno">
                                <h:outputText value="#{turno.turno.toString()}" />
                            </p:column>
                            <p:column style="width: 90px;">
                                     <h:commandButton 
                                        image="/faces/resources/images/view.png" 
                                        action="#{embarqueController.prepareViewTE}" 
                                        value="#{bundleCarga.TurnoEmbarqueViewLink}"
                                        title="#{bundleCarga.TurnoEmbarqueViewLink}"
                                        />

                                    <h:commandButton 
                                        image="/faces/resources/images/edit.png" 
                                        action="#{embarqueController.prepareEditTE}" 
                                        value="#{bundleCarga.TurnoEmbarqueEditLink}"
                                        title="#{bundleCarga.TurnoEmbarqueEditLink}"
                                        />

                                    <h:commandButton 
                                        image="/faces/resources/images/destroy.png"
                                        onclick="return confirm('Â¿Esta seguro que desea eliminar este Turno?');" 
                                        action="#{embarqueController.destroyTE}" 
                                        title="#{bundleCarga.TurnoEmbarqueDestroyLink}"
                                        value="#{bundleCarga.TurnoEmbarqueDestroyLink}"
                                        />
                            </p:column>
                        </p:dataTable>
                        <h:commandButton 
                                image="/faces/resources/images/new.png" 
                                action="#{embarqueController.prepareCreateTE()}" 
                                value="#{bundleCarga.TurnoEmbarqueCreateLink}"
                                title="#{bundleCarga.TurnoEmbarqueCreateLink}"
                                />

                    </p:fieldset>
                    
                </div> 
                <div style="min-width: 350px; float: left;" >
                    <p:fieldset id="panCargaPrevia" legend="Carga Previa" toggleable="true" >
                        
                        <Cc:embarqueCargaPrevia nuevo="false"/>
                        
                    </p:fieldset>
                    
                    <p:fieldset id="panArchivos" legend="Archivos" toggleable="true">
                        <h:panelGrid columns="2">
                            <p:fileUpload id="fupArchivoASubir" value="#{embarqueController.currentFile}" mode="simple"  />

                            <p:commandButton value="+" ajax="false" process="panArchivos" 
                                             actionListener="#{embarqueController.subirArchivo()}"
                                             /> 
                        </h:panelGrid>
                        <h:dataTable id="dtbLinkArchivos" value="#{embarqueController.archivosModel}"  var="archivo"  >
                            <p:column>
                                <h:link value="#{archivo.nombreArchivo}" onclick="window.open('#{archivo.urlCompleto}','Download');window.close();" />
                            </p:column>
                            <p:column>
                                <p:commandButton value="x" ajax="false" process="panArchivos" 
                                                 actionListener="#{embarqueController.eliminarArchivo()}"
                                             /> 
                            </p:column>
                        </h:dataTable>
                    </p:fieldset>                    
                </div>
                
                
                <p:panel style="width: 100%; float: left;" > 
                    <h:panelGrid columns="3" >

                        <h:commandButton action="#{embarqueController.update}" 
                                         image="/faces/resources/images/save.png" 
                                         value="#{bundleCarga.EmbarqueSaveLink}"
                                         title="#{bundleCarga.EmbarqueSaveLink}"
                                         />
                        <h:commandButton action="View" 
                                         value="#{bundleCarga.EmbarqueViewLink}" 
                                         image="/faces//resources/images/view.png" 
                                         immediate="true"
                                         title="#{bundleCarga.EmbarqueViewLink}"
                                         />
                        <h:commandButton action="#{embarqueController.prepareList}"
                                         image="/faces/resources/images/viewAll.png" 
                                         value="#{bundleCarga.EmbarqueShowAllLink}"
                                         immediate="true"
                                         title="#{bundleCarga.EmbarqueShowAllLink}"
                                         />
                    </h:panelGrid> 
                    
                </p:panel> 
            </h:form>
        </ui:define>
    </ui:composition>

</html>
